<!DOCTYPE HTML>
<html lang="en-US" manifest="../manifest.appcache">
    <head prefix="og: http://ogp.me/ns# book: http://ogp.me/ns/book#">
        
        <meta charset="UTF-8">
        <title>Auditing Source | CTF Field Guide</title>

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="robots" content="index, follow">
        <meta name="author" content="trailofbits">
        <meta name="description" content="“Knowing is not enough; we must apply. Willing is not enough; we must do.” - Johann Wolfgang von Goethe">
        <meta name="keywords" content="gitbook,github" >
        <meta name="generator" content="www.gitbook.io">

        
        <link rel="next" href="../vulnerabilities/binary.html" />
        
        
        <link rel="prev" href="../vulnerabilities/README.html" />
        

        <meta property="og:title" content="Auditing Source | CTF Field Guide">
        <meta property="og:site_name" content="CTF Field Guide">
        <meta property="og:type" content="book">
        <meta property="og:locale" content="en_US">

        <meta property="book:author" content="https://github.com/trailofbits">
        <meta property="book:tag" content="GitBook">

        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">

        <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">
        
    </head>
    <body>
        

        <link rel="stylesheet" href="../gitbook/style.css">
        


        
    <div class="book" data-github="trailofbits/ctf" data-level="2.1" data-basepath=".." data-revision="1400537321467">
    <div class="book-header">
    <!-- Actions Left -->
    
    <a href="https://github.com/trailofbits/ctf" target="_blank" class="btn pull-left home-bookmark" aria-label="GitHub home"><i class="fa fa-bookmark-o"></i></a>
    
    <a href="#" class="btn pull-left toggle-summary" aria-label="Toggle summary"><i class="fa fa-align-justify"></i></a>
    <a href="#" class="btn pull-left toggle-search" aria-label="Toggle search"><i class="fa fa-search"></i></a>
    <span id="font-settings-wrapper">
        <a href="#" class="btn pull-left toggle-font-settings" aria-label="Toggle font settings"><i class="fa fa-font"></i>
        </a>
        <div class="dropdown-menu font-settings">
    <div class="dropdown-caret">
        <span class="caret-outer"></span>
        <span class="caret-inner"></span>
    </div>

    <div class="btn-group btn-block">
        <button id="reduce-font-size" class="btn btn-default">A</button>
        <button id="enlarge-font-size" class="btn btn-default">A</button>
    </div>

    <ul class="list-group font-family-list">
        <li class="list-group-item" data-font="0">Serif</li>
        <li class="list-group-item" data-font="1">Sans</li>
    </ul>

    <div class="btn-group btn-group-xs btn-block color-theme-list">
        <button type="button" class="btn btn-default" id="color-theme-preview-0" data-theme="0">White</button>
        <button type="button" class="btn btn-default" id="color-theme-preview-1" data-theme="1">Sepia</button>
        <button type="button" class="btn btn-default" id="color-theme-preview-2" data-theme="2">Night</button>
    </div>
</div>

    </span>

    <!-- Actions Right -->
    
    <a href="#" target="_blank" class="btn pull-right google-plus-sharing-link sharing-link" data-sharing="google-plus" aria-label="Share on Google Plus"><i class="fa fa-google-plus"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right facebook-sharing-link sharing-link" data-sharing="facebook" aria-label="Share on Facebook"><i class="fa fa-facebook"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right twitter-sharing-link sharing-link" data-sharing="twitter" aria-label="Share on Twitter"><i class="fa fa-twitter"></i></a>
    

    
    <a href="https://github.com/trailofbits/ctf/stargazers" target="_blank" class="btn pull-right count-star hidden-xs"><i class="fa fa-star-o"></i> Star (<span>-</span>)</a>
    <a href="https://github.com/trailofbits/ctf/watchers" target="_blank" class="btn pull-right count-watch hidden-xs"><i class="fa fa-eye"></i> Watch (<span>-</span>)</a>
    

    <!-- Title -->
    <h1>
        <i class="fa fa-spinner fa-spin"></i>
        <a href="../" >CTF Field Guide</a>
    </h1>
</div>

    <div class="book-summary">
    <div class="book-search">
        <input type="text" placeholder="Search" class="form-control" />
    </div>
    <ul class="summary">
        
        <li>
            <a href="https://github.com/trailofbits" target="blank" class="author-link">About the author</a>
        </li>
        

        
        <li>
            <a href="https://github.com/trailofbits/ctf/issues" target="blank"class="issues-link">Questions and Issues</a>
        </li>
        

        
        <li>
            <a href="https://github.com/trailofbits/ctf/edit/master/vulnerabilities/source.md" target="blank" class="contribute-link">Edit and Contribute</a>
        </li>
        

        

        <li data-level="0" data-path="index.html">
            <a href="../"><i class="fa fa-check"></i> Introduction</a>
        </li>
        
            <li class="chapter " data-level="1" data-path="ctf.html">
                
                <a href="../ctf.html">
                    <i class="fa fa-check"></i> <b>1.</b> Capture the Flag
                </a>
                
                
            </li>
        
            <li class="chapter " data-level="2" data-path="vulnerabilities/README.html">
                
                <a href="../vulnerabilities/README.html">
                    <i class="fa fa-check"></i> <b>2.</b> Vulnerability Discovery
                </a>
                
                
                <ul class="articles">
                    
                        <li  data-level="2.1" data-path="vulnerabilities/source.html">
                            
                            <a href="../vulnerabilities/source.html">
                                <i class="fa fa-check"></i> <b>2.1.</b> Auditing Source
                            </a>
                            
                        </li>
                    
                        <li  data-level="2.2" data-path="vulnerabilities/binary.html">
                            
                            <a href="../vulnerabilities/binary.html">
                                <i class="fa fa-check"></i> <b>2.2.</b> Auditing Binaries
                            </a>
                            
                        </li>
                    
                        <li  data-level="2.3" data-path="web/vulnerabilities.html">
                            
                            <a href="../web/vulnerabilities.html">
                                <i class="fa fa-check"></i> <b>2.3.</b> Auditing Webapps
                            </a>
                            
                        </li>
                    
                </ul>
                
            </li>
        
            <li class="chapter " data-level="3" data-path="exploits/README.html">
                
                <a href="../exploits/README.html">
                    <i class="fa fa-check"></i> <b>3.</b> Exploit Creation
                </a>
                
                
                <ul class="articles">
                    
                        <li  data-level="3.1" data-path="exploits/binary1.html">
                            
                            <a href="../exploits/binary1.html">
                                <i class="fa fa-check"></i> <b>3.1.</b> Binary Exploits 1
                            </a>
                            
                        </li>
                    
                        <li  data-level="3.2" data-path="exploits/binary2.html">
                            
                            <a href="../exploits/binary2.html">
                                <i class="fa fa-check"></i> <b>3.2.</b> Binary Exploits 2
                            </a>
                            
                        </li>
                    
                        <li  data-level="3.3" data-path="web/exploits.html">
                            
                            <a href="../web/exploits.html">
                                <i class="fa fa-check"></i> <b>3.3.</b> Webapp Exploits
                            </a>
                            
                        </li>
                    
                </ul>
                
            </li>
        
            <li class="chapter " data-level="4" data-path="forensics/README.html">
                
                <a href="../forensics/README.html">
                    <i class="fa fa-check"></i> <b>4.</b> Forensics
                </a>
                
                
            </li>
        
            <li class="chapter " data-level="5" data-path="toolkits/README.html">
                
                <a href="../toolkits/README.html">
                    <i class="fa fa-check"></i> <b>5.</b> Toolkit Creation
                </a>
                
                
                <ul class="articles">
                    
                        <li  data-level="5.1" data-path="toolkits/prep.html">
                            
                            <a href="../toolkits/prep.html">
                                <i class="fa fa-check"></i> <b>5.1.</b> Toolkit Prep
                            </a>
                            
                        </li>
                    
                </ul>
                
            </li>
        
            <li class="chapter " data-level="6" data-path="tradecraft/README.html">
                
                <a href="../tradecraft/README.html">
                    <i class="fa fa-check"></i> <b>6.</b> Operational Tradecraft
                </a>
                
                
                <ul class="articles">
                    
                        <li  data-level="6.1" data-path="tradecraft/case_studies.html">
                            
                            <a href="../tradecraft/case_studies.html">
                                <i class="fa fa-check"></i> <b>6.1.</b> Case Studies
                            </a>
                            
                        </li>
                    
                </ul>
                
            </li>
        
            <li class="chapter " data-level="7" data-path="contrib/README.html">
                
                <a href="../contrib/README.html">
                    <i class="fa fa-check"></i> <b>7.</b> Contributors
                </a>
                
                
            </li>
        

        
        <li class="divider"></li>
        <li>
            <a href="http://www.gitbook.io/" target="blank" class="gitbook-link">Generated using GitBook</a>
        </li>
        
    </ul>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="page-wrapper" tabindex="-1">
                <div class="book-progress">
    <div class="bar">
        <div class="inner" style="width: 20%;min-width: 13.333333333333334%;"></div>
    </div>
    <div class="chapters">
    
        <a href="../index.html" title="Introduction" class="chapter done new-chapter" data-progress="0" style="left: 0%;"></a>
    
        <a href="../ctf.html" title="Capture the Flag" class="chapter done new-chapter" data-progress="1" style="left: 6.666666666666667%;"></a>
    
        <a href="../vulnerabilities/README.html" title="Vulnerability Discovery" class="chapter done new-chapter" data-progress="2" style="left: 13.333333333333334%;"></a>
    
        <a href="../vulnerabilities/source.html" title="Auditing Source" class="chapter done " data-progress="2.1" style="left: 20%;"></a>
    
        <a href="../vulnerabilities/binary.html" title="Auditing Binaries" class="chapter  " data-progress="2.2" style="left: 26.666666666666668%;"></a>
    
        <a href="../web/vulnerabilities.html" title="Auditing Webapps" class="chapter  " data-progress="2.3" style="left: 33.333333333333336%;"></a>
    
        <a href="../exploits/README.html" title="Exploit Creation" class="chapter  new-chapter" data-progress="3" style="left: 40%;"></a>
    
        <a href="../exploits/binary1.html" title="Binary Exploits 1" class="chapter  " data-progress="3.1" style="left: 46.666666666666664%;"></a>
    
        <a href="../exploits/binary2.html" title="Binary Exploits 2" class="chapter  " data-progress="3.2" style="left: 53.333333333333336%;"></a>
    
        <a href="../web/exploits.html" title="Webapp Exploits" class="chapter  " data-progress="3.3" style="left: 60%;"></a>
    
        <a href="../forensics/README.html" title="Forensics" class="chapter  new-chapter" data-progress="4" style="left: 66.66666666666667%;"></a>
    
        <a href="../toolkits/README.html" title="Toolkit Creation" class="chapter  new-chapter" data-progress="5" style="left: 73.33333333333333%;"></a>
    
        <a href="../toolkits/prep.html" title="Toolkit Prep" class="chapter  " data-progress="5.1" style="left: 80%;"></a>
    
        <a href="../tradecraft/README.html" title="Operational Tradecraft" class="chapter  new-chapter" data-progress="6" style="left: 86.66666666666667%;"></a>
    
        <a href="../tradecraft/case_studies.html" title="Case Studies" class="chapter  " data-progress="6.1" style="left: 93.33333333333333%;"></a>
    
        <a href="../contrib/README.html" title="Contributors" class="chapter  new-chapter" data-progress="7" style="left: 100%;"></a>
    
    </div>
</div>

                <div class="page-inner">
                
                    <section class="normal" id="section-gitbook_13">
                    
                        <h1 id="auditing-source-code">Auditing Source Code</h1>
<p>This module is about getting familiar with vulnerabilities that manifest in applications that compile to native code. An accurate and complete understanding of an application written in a compiled language cannot be achieved without learning about how the compiler transforms source to machine code and how processors execute that code. An easy way to gain experience with these transforms is by reverse engineering compiled variants of your own code or of projects with source code available. At the end of this module you will be able to identify vulnerabilities in compiled languages like C and C++.</p>
<p>Vulnerabilities are commonly identified in large software packages due to their use of third-party software libraries. Common examples include libraries like libxml, libpng, libpoppler, and libfreetype that parse complicated file formats and protocols. Each of these libraries have historically been prone to software flaws that make the applications using them vulnerable to attack. It doesn&#39;t help that most software packages fail to update these libraries when new versions come out, making it significant easier to find known vulnerabilities to apply in these cases.</p>
<h2 id="lecture">Lecture</h2>
<ul>
<li><a href="http://vimeo.com/30001189" target="_blank">Source Code Auditing I</a></li>
<li><a href="http://vimeo.com/29702192" target="_blank">Source Code Auditing II</a></li>
</ul>
<h2 id="workshop">Workshop</h2>
<p>In order to practice your skills, we recommend going through the process of identifying as many vulnerabilities as you can in an intentionally vulnerable toy application and then moving on to a real application and doing the same.</p>
<p>The Newspaper application is a small server written in C that allows authenticated users to read and write articles to a remote file system. Newspaper is written in such a way that it is vulnerable to many different attacks. You should be capable of identifying at least 10 bugs or potential vulnerabilities in this code.</p>
<ul>
<li><a href="http://pentest.cryptocity.net/files/code_analysis/fall2011_hw2.c" target="_blank">Newspaper App</a></li>
<li><a href="http://pentest.cryptocity.net/files/code_analysis/fall2011_install.sh" target="_blank">Newspaper App Installer</a></li>
</ul>
<p>Wireshark, however, is an industry standard network protocol analyzer that has been under continuous development since 1998. Vulnerabilities in this code base are much fewer and far between than in the Newspaper app however many still exist. Take a look at the <a href="http://wireshark.org/security" target="_blank">wireshark security page</a>, find the name of a protocol dissector and see if you can independently discover the vulnerability without looking at the details. Dissectors are located in /epan/dissectors/ folder.</p>
<ul>
<li><a href="http://www.wireshark.org/download/src/all-versions/wireshark-1.8.5.tar.bz2" target="_blank">Wireshark 1.8.5</a></li>
</ul>
<h2 id="tools">Tools</h2>
<p>When auditing, it is help to use a tool design to profile and navigate the codebase. Below are two tools, Source Navigator and Understand, designed to help analysts get familiar with code quickly by collecting and displaying information about data relationships, API usage, design patterns and control flow. An example of a useful diffing tool is also listed below. One example of a free, open source code auditing tool is the Clang Static Analyzer, which can help you track down programming errors in common APIs and vulnerable programming patterns.</p>
<ul>
<li><a href="http://sourcenav.sourceforge.net/" target="_blank">Source Navigator</a></li>
<li><a href="http://www.scitools.com/" target="_blank">Scitools Understand</a></li>
<li><a href="http://meldmerge.org/" target="_blank">Meld</a></li>
<li><a href="http://clang-analyzer.llvm.org/" target="_blank">Clang Static Analyzer</a></li>
</ul>
<h2 id="resources">Resources</h2>
<p>Make sure you’re intimately familiar with the internals of the languages you target for analysis.  Vulnerabilities are found by auditors who are more familiar with the language and the codebase than the programmers that originally developed it. In some cases, this level of understanding can be achieved simply by paying attaching to optional compiler warnings or through the use of third-party analysis tools that help track down common programming errors. Computer security is tantamount to computer mastery. Without a rigorous understanding of your targets you can never hope to defeat them.</p>
<ul>
<li><a href="/vulnerabilities/references/EssentialC.pdf">Essential C</a> - Programming in C primer</li>
<li><a href="/vulnerabilities/references/Dowd_ch06.pdf">TAOSSA Chapter 6: C Language Issues</a> - Strongly recommended reading</li>
<li><a href="http://en.wikipedia.org/wiki/Integer_overflow" target="_blank">Integer Overflow</a></li>
<li><a href="https://wireshark.org/security/" target="_blank">Wireshark Security</a> - Examples of lots of vulnerablities</li>
<li><a href="http://community.coresecurity.com/~gera/InsecureProgramming/" target="_blank">Gera&#39;s Insecure Programming by Example</a> - Examples of small vulnerable C programs</li>
</ul>

                    
                    </section>
                
                </div>
            </div>
        </div>

        
        <a href="../vulnerabilities/README.html" class="navigation navigation-prev " aria-label="Previous page: Vulnerability Discovery"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="../vulnerabilities/binary.html" class="navigation navigation-next " aria-label="Next page: Auditing Binaries"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        

        <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.3/ace.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.3/mode-javascript.js"></script>
        <script src="../gitbook/jsrepl/jsrepl.js" id="jsrepl-script"></script>
        <script src="../gitbook/app.js"></script>
        

    
    <script src="../gitbook/plugins/gitbook-plugin-ga/plugin.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {"ga":{"token":"UA-37017099-3"}};
    gitbook.start(config);
});
</script>

    </body>
</html>
